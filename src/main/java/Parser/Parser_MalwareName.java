package Parser;

import java.util.ArrayList;

import Criteria.Config_Class;
import Criteria.Stanford_Class;

public class Parser_MalwareName
{
	Boolean haved = false;
	ArrayList<Stanford_Class> Content;
	// ArrayList<Integer> Filtered_Content_Index = new ArrayList<Integer>();

	public void parse(Config_Class configs, ArrayList<Stanford_Class> content)
	{
		this.Content = null;
		this.Content = new ArrayList<Stanford_Class>(content);
		Get_MalwareName_Form_Term(configs);
	}

	public int get_parse()
	{
		if (haved)
		{
			return 1;
		}
		else
		{
			return 0;
		}
	}

	public void Get_MalwareName_Form_Term(Config_Class configs)
	{
		// 看前後詞
		haved = false;
		int index = 0;
		int From = 0, End = 0;
		// int from = 0;
		// this.Filtered_Content_Index.clear();
		for (int i = 0; i < this.Content.size(); i++)
		{
			for (String s : configs.get_term_list())
			{
				if (this.Content.get(i).get_Lemma().contains(s))
				{
					index = this.Content.get(i).get_Lemma().indexOf(s);
					From = index - configs.get_term();
					if (From < 0)
					{
						From = 0;
					}
					End = index + configs.get_term();
					if (End >= this.Content.get(i).get_Pos().size())
					{
						End = this.Content.get(i).get_Pos().size();
					}
					for (int j = From; j < End; j++)
					{
						try
						{
							if (this.Content.get(i).get_Pos().get(j).contains("NN")
									&& Check_HaveUperLetter(this.Content.get(i).get_token().get(j)))
							{
								System.out.println(this.Content.get(i).get_sentence());
								haved = true;
								//break;
							}
						}
						catch (IndexOutOfBoundsException e)
						{
							System.out.println("this is last one\r\n" + this.Content.size() + "\r\n"
									+ this.Content.get(i).get_token().size() + "\r\nEND:" + End + "\r\nj:" + j);
						}
					}
					// System.out.println("\r\n" + "malware name:");
					// System.out.println(this.Content.get(i).get_sentence());
					// for (int j = from; j < index + 1; j++)
					// {
					// System.out.print(this.Content.get(i).get_Lemma().get(j) +
					// " ");
					// }

					// else if (this.Content.get(i).get_Pos().get(index +
					// 1).contains("NN"))
					// {
					// for (int j = index + 1; j <
					// this.Content.get(i).get_Pos().size(); j++)
					// {
					// if (this.Content.get(i).get_Pos().get(j).contains("NN"))
					// {
					//// from = j;
					// }
					// }
					//// System.out.println("\r\n" + "malware name:");
					//// System.out.println(this.Content.get(i).get_sentence());
					//// for (int j = index; j < from + 1; j++)
					//// {
					//// System.out.print(this.Content.get(i).get_Lemma().get(j)
					// + " ");
					//// }
					// }
				}
			}
		}
	}

	public boolean Check_HaveUperLetter(String str)
	{
		Boolean haved = false;
		char[] c_list = str.toCharArray();
		for (char c : c_list)
		{
			if (65 <= (int) c && (int) c <= 90)
			{
				haved = true;
				break;
			}
		}
		return haved;
	}
}
